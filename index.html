<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>TEESFORACAUSE: DONATION DRIVE</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Fonts & combined stylesheet (kept from original) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@600;700&family=Karla:wght@400;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Bagel+Fat+One&family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Playwrite+FR+Moderne:wght@100..400&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Playpen+Sans+Thai:wght@100..800&display=swap" rel="stylesheet">

  <style>
    /* (styles identical to the original file for brevity) */
:root{ --bg:#F5EFE6; --paper:#FFFFFC; --ink:#111111; --muted:#5d5d5d; --border:#d9d2c6; --accent:#111111; --accent-contrast:#ffffff; --font-heading:"Bagel Fat One", system-ui, sans-serif; --font-body:"Playpen Sans Thai", system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; --font-accent:"Playwrite FR Moderne", system-ui, sans-serif; --form-max: 880px; --hero-max: 920px; --logo-x:50%; --logo-y:50%; }
*,*::before,*::after{ box-sizing:border-box; }
html,body{ height:100%; }
body{ margin:0; min-height:100vh; background: linear-gradient(var(--bg), var(--bg)), url("https://www.transparenttextures.com/patterns/handmade-paper.png"); color:var(--ink); font-family:var(--font-body); padding:24px; overflow-x:clip; }
.page-thanks{ min-height:100vh; min-height:100svh; display:flex; align-items:center; justify-content:center; }
.page-index{ padding-bottom: clamp(96px, 14vh, 200px); }
h1{ margin:0; font-family:var(--font-heading); font-weight:700; font-size:36px; line-height:1.25; letter-spacing:.2px; }
.logo{ width:200px; height:200px; border-radius:50%; object-fit:contain; object-position:var(--logo-x) var(--logo-y); border:6px solid var(--ink); background:transparent; box-shadow:0 4px 12px rgba(0,0,0,.18); display:block; }
.card{ position:relative; width:100%; max-width:var(--form-max); background: linear-gradient(var(--paper), var(--paper)), url("https://www.transparenttextures.com/patterns/paper-1.png"); border:1px solid var(--border); border-radius:14px; padding:26px 22px 22px; box-shadow:0 10px 24px rgba(0,0,0,0.15), 0 2px 0 rgba(0,0,0,0.04); overflow:hidden; margin-inline:auto; }
.wrap{ position:relative; width:100%; max-width:var(--hero-max); background: linear-gradient(var(--paper), var(--paper)), url("https://www.transparenttextures.com/patterns/paper-1.png"); border:1px solid var(--border); border-radius:14px; padding:32px 26px 28px; box-shadow:0 10px 24px rgba(0,0,0,0.15), 0 2px 0 rgba(0,0,0,0.04); overflow:hidden; margin-inline:auto; }
.header{ display:flex; align-items:center; gap:14px; margin-bottom:8px; flex-wrap:wrap; }
.header .logo{ width:68px; height:68px; border-width:2px; }
.btn{ display:inline-flex; align-items:center; gap:8px; background:var(--accent); color:var(--accent-contrast); border:1px solid var(--accent); padding:12px 16px; border-radius:12px; cursor:pointer; font-weight:700; font-family:var(--font-body); text-decoration:none; transition:background .2s ease, color .2s ease, border-color .2s ease, transform .05s ease; user-select:none; }
.btn:hover{ background:transparent; color:var(--ink); border-color:var(--ink); }
.btn:active{ transform:translateY(1px); }
.btn[disabled]{ opacity:.6; cursor:not-allowed; }
form{ display:grid; gap:16px; }
label{ display:block; font-family:var(--font-accent); font-weight:700; font-size:14px; margin-bottom:4px; }
input[type="text"], input[type="email"], input[type="tel"], textarea{ width:100%; padding:12px 14px; border-radius:10px; border:1px solid var(--border); background:#ffffff; color:var(--ink); outline:none; font-family:var(--font-body); font-size:14px; line-height:1.45; transition: box-shadow .15s ease, border-color .15s ease, background-color .15s ease; }
input::placeholder, textarea::placeholder{ color:#8a8a8a; }
input[type="text"]:focus, input[type="email"]:focus, input[type="tel"]:focus, textarea:focus{ border-color:#bfb8ab; box-shadow:0 0 0 3px rgba(17,17,17,.06); background:#fff; }
.checkbox-group{ display:flex; align-items:center; gap:10px; padding:12px 14px; border-radius:10px; border:1px solid var(--border); background:#ffffff; transition: box-shadow .15s ease, border-color .15s ease; }
.checkbox-group:focus-within{ border-color:#bfb8ab; box-shadow:0 0 0 3px rgba(17,17,17,.06); }
input[type="checkbox"]{ width:20px; height:20px; cursor:pointer; accent-color:var(--accent); }
.checkbox-label{ font-family:var(--font-body); font-size:14px; cursor:pointer; user-select:none; }
.row{ display:grid; gap:14px; grid-template-columns:1fr; }
.row > *{ min-width:0; }
.hint{ color:var(--muted); font-size:13px; margin-top:6px; font-family:var(--font-body); }
.actions{ display:flex; gap:12px; align-items:center; flex-wrap:wrap; margin-top:6px; }
.status{ font-size:14px; color:var(--muted); min-height:20px; font-family:var(--font-body); }
.status.error{ color:#b00020; }
.wrap--hero{ text-align:center; z-index:1; }
.tape{ position:absolute; width:110px; height:24px; background: linear-gradient(0deg, rgba(0,0,0,.06), rgba(0,0,0,.06)) padding-box, repeating-linear-gradient(90deg, #f7f0e6 0 10px, #efe6d9 10px 20px) border-box; border:1px solid rgba(0,0,0,.08); border-radius:4px; box-shadow:0 2px 6px rgba(0,0,0,0.12); opacity:.95; }
@media (max-width: 900px){ .card{ max-width: min(var(--form-max), 94vw); } .wrap{ max-width: 94vw; } }
  </style>
</head>
<body class="page-index">
  <div class="card" role="form" aria-label="Design submission form">
    <div class="header">
      <img class="logo" src="./tfac.png" alt="TFAC logo" />
      <h1>TEESFORACAUSE: DONATION DRIVE</h1>
    </div>

    <p class="hint" style="margin: 0 0 8px 0;">Fill in your details to participate in the competition!</p>

    <!-- Only the requested columns / inputs are present: name, age, email, number, confirmation -->
    <form id="submissionForm" novalidate>
      <div class="row">
        <div>
          <label for="name">Name</label>
          <input id="name" name="name" type="text" placeholder="Your full name" required />
        </div>
      </div>

      <div class="row">
        <div>
          <label for="email">Email</label>
          <input id="email" name="email" type="email" placeholder="you@example.com" required />
        </div>
      </div>

      <div class="row">
        <div>
          <label for="age">Age</label>
          <input id="age" name="age" type="text" inputmode="numeric" pattern="[0-9]*" placeholder="e.g., 16" required />
        </div>
      </div>

      <div class="row">
        <div>
          <label for="number">Phone number</label>
          <input id="number" name="number" type="tel" placeholder="10 digits" required />
        </div>
      </div>

      <div class="row">
        <div>
          <label for="confirmation">Confirmation</label>
          <div class="checkbox-group">
            <input id="confirmation" name="confirmation" type="checkbox" required />
            <label for="confirmation" class="checkbox-label">I confirm my participation (Yes)</label>
          </div>
          <p class="hint">Please check the box to confirm your participation</p>
        </div>
      </div>

      <div class="actions">
        <button id="submitBtn" class="btn" type="submit">Submit entry</button>
        <div id="status" class="status" role="status" aria-live="polite"></div>
      </div>
    </form>
  </div>

  <div id="thanks" class="wrap" role="status" aria-live="polite" hidden>
    <img class="logo" src="./tfac.png" alt="TFAC logo" />
    <h1 style="margin: 8px 0 8px 0;">Submission received!</h1>
    <p class="hint" style="margin: 0;">Thank you for participating. We'll be in touch soon.</p>
  </div>

  <script type="module">
    import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm";

    // Supabase config (kept from user)
    const SUPABASE_URL = "https://xkrokzdjegxawyqgyfkr.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inhrcm9remRqZWd4YXd5cWd5ZmtyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU0NzExODQsImV4cCI6MjA4MTA0NzE4NH0.hPGz4gHlnYvyPnaT5KIKLEOTGZ9pH_w7UYP3Yi13ekk";
    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // Keep the table name here so it's easy to change later
    const TABLE = "submissions";

    const form = document.getElementById("submissionForm");
    const submitBtn = document.getElementById("submitBtn");
    const statusEl = document.getElementById("status");
    const thanks = document.getElementById("thanks");
    const card = document.querySelector(".card");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      clearStatus();

      const name = form.name.value.trim();
      const email = form.email.value.trim();
      const ageRaw = form.age.value.trim();
      const number = form.number.value.trim();
      const confirmation = form.confirmation.checked;

      if (!name) return setError("Please enter your name.");
      if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) return setError("Please enter a valid email.");
      if (!ageRaw || isNaN(Number(ageRaw)) || Number(ageRaw) < 5 || Number(ageRaw) > 120) return setError("Please enter a valid age.");
      if (!number || !/^\d{10}$/.test(number)) return setError("Please enter a valid 10-digit mobile number.");
      if (!confirmation) return setError("Please confirm your participation.");

      submitBtn.disabled = true;
      setStatus("Submitting your entryâ€¦");

      try {
        const payload = {
          name,
          email,
          age: Number(ageRaw),
          number,
          confirmation: true,
          submitted_at: new Date().toISOString(),
        };

        // Insert and return the new row's id (Postgres will return the inserted row)
        const { data: inserted, error: insertError } = await supabase
          .from(TABLE)
          .insert([payload])
          .select('id')
          .single();

        if (insertError) {
          // Supabase error may contain .message but can also contain details
          throw insertError;
        }

        const submissionId = inserted && inserted.id ? inserted.id : null;
        console.log('Inserted submission ID:', submissionId);

        setStatus("Submission successful!");
        // show thank-you
        card.hidden = true;
        thanks.hidden = false;
        window.scrollTo({ top: 0, behavior: "smooth" });
      } catch (err) {
        console.error(err);
        // friendly, developer-detailed message for debugging
        const msg = (err && err.message) ? err.message : (err && err.details) ? err.details : "Something went wrong. Please try again.";
        setError(msg);
      } finally {
        submitBtn.disabled = false;
      }
    });

    function setStatus(msg) { statusEl.textContent = msg; statusEl.classList.remove("error"); }
    function setError(msg) { statusEl.textContent = msg; statusEl.classList.add("error"); }
    function clearStatus() { statusEl.textContent = ""; statusEl.classList.remove("error"); }
  </script>

  <script nomodule>
    document.body.insertAdjacentHTML(
      "afterbegin",
      '<div style="background:#fff3cd;border:1px solid #ffeeba;padding:12px;border-radius:8px;margin-bottom:12px;font:14px/1.4 -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif;">Your browser doesn't support modern JavaScript modules. Please update Safari to the latest version.</div>'
    );
  </script>
</body>
</html>

